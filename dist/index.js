"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("rxdb"),t=require("axios"),r=require("mobx"),i=require("faker"),n=require("@/src/lib/static/data/currencies/ids.json"),a=require("consola"),o=require("rxcollection-subscriber");function s(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var u=s(t),c=s(i),l=s(n),f=s(a),d=s(o),p=function(e,t){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function h(e,t){function r(){this.constructor=e}p(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var b=function(){return(b=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function m(e,t,r,i){var n,a=arguments.length,o=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(o=(a<3?n(o):a>3?n(t,r,o):n(t,r))||o);return a>3&&o&&Object.defineProperty(t,r,o),o}function v(e,t,r,i){return new(r||(r=Promise))((function(n,a){function o(e){try{u(i.next(e))}catch(e){a(e)}}function s(e){try{u(i.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((i=i.apply(e,t||[])).next())}))}function y(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function g(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var i=Array(e),n=0;for(t=0;t<r;t++)for(var a=arguments[t],o=0,s=a.length;o<s;o++,n++)i[n]=a[o];return i}var x,O,w,j,_=String(process.env.NODE_ENV),P={version:require("../package.json").version,taxonomii:{defaults:{criteriu:{limit:25,index:0,sort:{},find:null}},asociatii:{criteriu:{limit:100}}},build:{db:{name:"Lodger/$",adapter:"memory",password:"l0dg3rp4$$",ignoreDuplicate:Boolean("test"===_)}}},k=function(e){function t(r,i){var n;return i&&(r=String(r).replace("%%",'"'+JSON.stringify(i)+'"')),n=e.call(this,r)||this,Object.setPrototypeOf(n,t.prototype),n}return h(t,e),t}(Error);!function(e){e[e.buildingName=0]="buildingName",e[e.fullName=1]="fullName",e[e.search=2]="search",e[e.select=3]="select",e[e.serviceName=4]="serviceName",e[e.string=5]="string",e[e.textarea=6]="textarea",e[e.userAvatar=7]="userAvatar"}(x||(x={})),function(e){e[e.date=0]="date",e[e.dateTime=1]="dateTime",e[e.number=2]="number",e[e.rol=3]="rol"}(O||(O={})),function(e){e[e.array=0]="array",e[e.contoare=1]="contoare",e[e.distribuire=2]="distribuire",e[e.furnizori=3]="furnizori",e[e.selApartamente=4]="selApartamente",e[e.servicii=5]="servicii",e[e.scari=6]="scari"}(w||(w={})),function(e){e[e.contactFields=0]="contactFields",e[e.object=1]="object",e[e.organizatie=2]="organizatie",e[e.$=3]="$"}(j||(j={}));var q={apartament:"apartamente",asociatie:"asociatii",bloc:"blocuri",contor:"contoare",cheltuiala:"cheltuieli",factura:"facturi",furnizor:"furnizori",incasare:"incasari",serviciu:"servicii",tranzactie:"tranzactii",utilizator:"utilizatori"};String.prototype.stripLeading=function(e){return 0!==this.indexOf(e)?String(this):String(this.replace(e,"").trim().stripLeading(e))},Object.defineProperties(String.prototype,{plural:{get:function(){return q[this]||String(this)}},asRxDBType:{get:function(){var e="string",t=this.toString();return Object.keys(x).indexOf(t)>-1?e:Object.keys(j).indexOf(t)>-1?"object":Object.keys(O).indexOf(t)>-1?"number":Object.keys(w).indexOf(t)>-1?"array":e}},asMoney:{get:function(){var e=this.split(" ");return{currency:e[0],amount:e[1]}}},slug:{get:function(){return this.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")}}});var I={String:String},z={};Object.defineProperties(z,{$:{get:function(){return{moneda:""+c.default.random.arrayElement(l.default),value:""+c.default.finance.amount(100,1e4,4)}}},id:{get:function(){return"..."}},string:{get:function(){return c.default.lorem.words(3)}},number:{get:function(){return Number(c.default.random.number({min:0,max:300}))}},fullName:{get:function(){return c.default.name.firstName()+" "+c.default.name.lastName()}},dateTime$:{get:function(){return Date.now()+c.default.random.number({min:9e6,max:1e8})}},buildingName:{get:function(){return c.default.random.alphaNumeric(2)}},serviceName:{get:function(){return c.default.hacker.adjective()}}});var D,A=I.String,N=function(){function e(e){var t=this;if(this.type="string",this.storage="db",this.value=function(){return t.default||void 0},this.key="index",e){var r=e.ref,i=e.focus,n=e.index,a=e.indexRef,o=e.type,s=e.step,u=e.required,c=e.v,l=e.value,f=e.preview,d=e.oninput,p=e.key,h=e.fieldset,b=e.search;if(this.preview=f,this._type=o,this.type=A(o||"").asRxDBType,this.oninput=d,this.focus=i,p&&(this.key=p),b&&(this.search=b),void 0!==n&&(this._index=!0),void 0!==h&&(this.fieldset=h),r&&(this.ref=r,this.items={type:"string"},a&&(this.index=a)),void 0!==s){if("number"!==this.type)throw new k('Type must be "number" for .step');this.multipleOf=s}u&&(this.v=u&&c&&c.indexOf("required")<0?c:"required|"+c),this.default="function"==typeof e.default?e.default():e.default;var m=this.storage;l&&"function"==typeof l&&(this.value=l.bind({storage:m})),Object.defineProperty(this,"fakeValue",{get:function(){return z[o||"string"]}}),"$"===this._type&&(this.final=!0,this.items={type:"object",properties:{value:{type:"number"},moneda:{type:"number"}}})}}return Object.defineProperty(e.prototype,"label",{get:function(){var e=this;return function(t){var r;void 0===t&&((r={})[e.key]="unnamed",t=r);try{return t[e.key]}catch(e){return"undefined label"}}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rxSchema",{get:function(){var e=this,t={},r=["storage","value","default","v"];return Object.keys(this).forEach((function(i){void 0!==e[i]&&(r.indexOf(i)>-1||(t[i]=e[i]))})),t},enumerable:!1,configurable:!0}),m([r.computed],e.prototype,"label",null),e}();!function(e){e.missingProps="Missing properties on schema %%",e.propExists='Property "%%" already exists',e.idUndef="ID for field %% cannot be undefined",e.invalidField="Invalid field %% supplied"}(D||(D={}));var S,E=function(){function e(e,t,r){var i=this;if(this.name=e,this.type="object",this.version=0,this.properties={},this.required=[],this.indexes=[],!t||!Object.keys(t).length)throw new k(D.missingFields,{name:e});Object.keys(t).map((function(e){return i.add(t[e].id||e,t[e])}))}return e.prototype.add=function(e,t){if(!e)throw new k(D.idUndef,t);if(this.properties[e])throw new k(D.propExists,e);if(t&&!t.rxSchema)throw new k(D.invalidField,t);var r=t.rxSchema,i=t.v,n=t.storage,a=t._index,o=t._type;if("db"===n){var s=i&&i.indexOf("required")>-1;this.properties[e]=r||{},s&&this.required.indexOf(e)<0&&this.required.push(e),a&&("$"!==o?this.indexes.push(e):this.indexes.push(e+".[].value"))}},Object.defineProperty(e.prototype,"ids",{get:function(){return Object.keys(this.properties)},enumerable:!1,configurable:!0}),e}();!function(e){e.invalidRequested="Invalid file requested: %%",e.invalidName="Invalid name supplied: %%",e.missingFields="Missing fields on form %%"}(S||(S={}));var $,F,T=function(){function e(e,t){var r=this;this.opts=t,this._onsubmit=[],this.fields={},this.$active=!1;var i=e||{name:"untitled",fields:{}},n=i.fields,a=i.fieldsets,o=i.name,s=i.hooks;if((this.name=o,this.fields={},this.plural=this.name.plural,n&&Object.keys(n).map((function(e){Object.assign(n[e],{key:e}),r.fields[e]=new N(n[e])})),a&&(this.fieldsets=a),s&&(this.taxHooks=s),t)&&t.captureTimestamp){var u={type:"dateTime",index:!0};["createdAt","updatedAt"].map((function(e){r.fields[e]=new N(b({},u))}))}this.schema=new E(o,this.fields),this.onsubmit=function(){}}return Object.defineProperty(e.prototype,"fakeData",{get:function(){var e=this;return Object.fromEntries(this.fieldsIds.filter((function(e){return e.indexOf("Id")<0})).map((function(t){return[t,e.fields[t].fakeValue]})))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return Object.assign.apply(Object,g([{}],Object.keys(this.fields)))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fieldsIds",{get:function(){return Object.keys(this.fields)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previewFields",{get:function(){var e=this;return this.fieldsIds.filter((function(t){return e.fields[t].preview>-1})).sort((function(t,r){return e.fields[t].preview-e.fields[r].preview}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onsubmit",{set:function(e){this._onsubmit.push(e.bind(this))},enumerable:!1,configurable:!0}),e.prototype.value=function(e){var t=this,r={};return this.fieldsIds.forEach((function(i){var n=t.fields[i];"db"===n.storage&&(r[i]=n.value(e))})),r},e}();function C(e){if(this&&"function"==typeof this.dispatch&&this.actions.notify)this.dispatch("notify",e);else{var t=e.type,r=e.text;if(f.default[t](r),"error"===t)throw new Error(r)}}($||($={})).noDB="Please setup a DB first!";var R=function(e){function t(){var t=e.apply(this,arguments)||this;return t.subscribers={},t._refsIds={},t}return h(t,e),t.init=function(){return e.init.apply(this,arguments)},Object.defineProperty(t.prototype,"data",{get:function(){return this.subscribers},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"refsIds",{get:function(){return this._refsIds},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"subscribed",{get:function(){return Object.keys(this.subscribers).length>0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"defaultCriteria",{get:function(){return e.prototype.config.criteriu},enumerable:!1,configurable:!0}),t.prototype.subscribe=function(e,t){return void 0===e&&(e="main"),v(this,void 0,void 0,(function(){var i,n,a,o,s,u,c=this;return y(this,(function(l){switch(l.label){case 0:return n=(i=this).hooks,i.subscribers[e]?[2]:(a=this.subscribers[e]=new d.default(this.collection,t),o=this.$lodger.mainSubName,this.parents&&this.parents.length&&!a.refsIds&&(a.refsIds=r.observable({})),s=[],u=function(t,r,i){return v(c,void 0,void 0,(function(){var n=this;return y(this,(function(a){return t&&t.length?(s.length||(s=g(this.$lodger.taxonomies)),t.map((function(t){var a,u,c=n.$lodger[t]||n.$lodger[t.plural];if(!c)return!0;if(!(s&&s.length&&s.indexOf(t.plural)>-1))return!0;s.splice(s.indexOf(t.plural),1);var l=c.subscribers,f=c.parents,d=(c.children,l[e]||l[o]);if(d){var p,h,b;if(d.selectedId&&d.select(d.selectedId),d.refsIds&&f&&f.length&&(f.indexOf(i)>-1||f.indexOf(i.plural)>-1)){var m=f.indexOf(i)>-1;p=m?i+"Id":n.form.plural,h=m?"$eq":"$in",b=m?r:[r],d.refsIds[p]=b}if(p&&h&&b)d.criteria.filter=((a={})[p]=((u={})[h]=b,u),a);else if(d.criteria.filter){try{delete d.criteria.filter[p]}catch(e){console.error("could not delete filter",p,"on",t,e)}0===Object.keys(d.criteria.filter).length&&(d.criteria.filter=null)}}else console.error("Invalid subscriber requested",e,t)})),[2]):[2]}))}))},r.reaction((function(){return a.selectedId}),(function(e){s=[],u(c.children,e,c.collection.name)})),r.reaction((function(){return a.activeId}),(function(e){return v(c,void 0,void 0,(function(){var t;return y(this,(function(r){switch(r.label){case 0:return e?[4,this.collection.findOne(e).exec()]:[2];case 1:return t=r.sent(),this.$lodger.modal.activeDoc=t,Object.assign(this.$lodger.modal,{sub:a}),[2]}}))}))})),n&&n.empty?[4,a.updates]:[3,2]);case 1:l.sent(),a.ids.length||n.empty.call(this),l.label=2;case 2:return[2]}}))}))},t.prototype.unsubscribe=function(e){void 0===e&&(e="main");var t=this.subscribers[e];try{t.kill&&t.kill()}catch(e){}delete this.subscribers[e]},t.prototype.unsubscribeAll=function(){var e=this,t=this.subscribers;if(!t||!Object.keys(t).length)throw new k("no subs");Object.keys(t).forEach((function(t){e.unsubscribe(t)}))},Object.defineProperty(t.prototype,"hooks",{get:function(){return this.form.taxHooks},enumerable:!1,configurable:!0}),m([r.observable],t.prototype,"_refsIds",void 0),m([r.computed],t.prototype,"refsIds",null),t}(function(){function e(e,t,r){var i=this;this.form=e,this.options=r,this.lastItems=[],this.totals=0,r&&r.timestamps&&t.preSave((function(e){e.updatedAt=(new Date).getTime()}),!1),t.postInsert((function(e,t){i.totals+=1,i.last=t._id,t.atomicUpdate((function(t){return t.createdAt=(new Date).getTime(),t.updatedAt=e.createdAt,t}))}),!1),t.postRemove((function(){i.totals-=1}),!1),e.fieldsIds.filter((function(t){return e.fields[t].search})).forEach((function(e){return t.searchFields.push(e)})),Object.defineProperty(this,"collection",{enumerable:!1,writable:!1,value:t})}return Object.defineProperty(e.prototype,"last",{get:function(){return this.lastItems[0]},set:function(e){e?this.lastItems.unshift(e):this.lastItems.shift()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"db",{set:function(e){F=e},enumerable:!1,configurable:!0}),e.destroy=function(){return v(this,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return F?[4,F.destroy()]:[2];case 1:return e.sent(),[2]}}))}))},Object.defineProperty(e.prototype,"plural",{get:function(){return this.form.plural},enumerable:!1,configurable:!0}),e.init=function(e,t){return void 0===t&&(t={}),v(this,void 0,void 0,(function(){var r,i,n,a,o,s,u,c,l,f,d,p;return y(this,(function(h){switch(h.label){case 0:if(!F)throw new k($.noDB);h.label=1;case 1:return h.trys.push([1,3,,4]),r=e.name,i=e.fields,n=e.fieldsets,a=e.methods,o=e.statics,s=e.hooks,u=t.timestamps,c=new T({name:r,fields:i,fieldsets:n,hooks:s},{captureTimestamp:u}),l=c.schema,f={name:r,schema:l,methods:a,statics:o},[4,F.collection(f)];case 2:return d=h.sent(),[2,new this(c,d,t)];case 3:throw p=h.sent(),new k(p);case 4:return[2]}}))}))},Object.defineProperty(e.prototype,"name",{get:function(){return this.collection.name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sortOptions",{get:function(){var e=this,t=e.$lodger,r=e.form,i=r.fields,n=r.schema.indexes,a=e.name,o=t.i18n;return Object.assign.apply(Object,g([{}],n.map((function(e){var t,r,n=e.replace(".[].","_"),s=n.split("_")[0],u=o.taxonomies[a.plural].fields[s]||o.sort.fields[s]||n,c=i[s].type,l="string"===c?["AZ","ZA"]:"number"===c?["09","90"]:["asc","desc"];return(t={})[u]=((r={})[n+"-asc"]=l[0],r[n+"-desc"]=l[1],r),t}))))},enumerable:!1,configurable:!0}),e.prototype.trash=function(e){return v(this,void 0,void 0,(function(){return y(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.collection.findOne(e).remove()];case 1:return t.sent(),this.last===e&&(this.last=void 0),[3,3];case 2:return C({type:"error",text:t.sent()}),[3,3];case 3:return[2]}}))}))},e.prototype.put=function(e){return v(this,void 0,void 0,(function(){var t,r,i,n,a,o;return y(this,(function(s){switch(s.label){case 0:if(!e||Object.keys(e).length<1)throw new k("Invalid doc supplied %%",{doc:e});t=e._id?"upsert":"insert",i=(r=this).name,r.options,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.collection[t](e)];case 2:return n=s.sent(),a=n._id,C({type:"success",text:"["+t+"] "+i+"!"+(["dev","test"].indexOf(_)>-1?"("+a+")":"")}),[2,n];case 3:return o=s.sent(),C({type:"error",text:String(o)}),[3,4];case 4:return[2]}}))}))},Object.defineProperty(e.prototype,"config",{get:function(){var e=P.taxonomii,t=e.defaults;return e[this.name]||t},enumerable:!1,configurable:!0}),m([r.observable],e.prototype,"lastItems",void 0),m([r.observable],e.prototype,"totals",void 0),m([r.computed],e.prototype,"last",null),m([r.computed],e.prototype,"sortOptions",null),e}()),B={"Apartament.ts":()=>Promise.resolve().then((function(){return ce})),"Asociatie.ts":()=>Promise.resolve().then((function(){return de})),"Bloc.ts":()=>Promise.resolve().then((function(){return pe})),"Cheltuiala.ts":()=>Promise.resolve().then((function(){return he})),"Contor.ts":()=>Promise.resolve().then((function(){return be})),"Factura.ts":()=>Promise.resolve().then((function(){return ve})),"Feedback.ts":()=>Promise.resolve().then((function(){return ye})),"Furnizor.ts":()=>Promise.resolve().then((function(){return ge})),"Incasare.ts":()=>Promise.resolve().then((function(){return xe})),"Serviciu.ts":()=>Promise.resolve().then((function(){return je})),"Tranzactie.ts":()=>Promise.resolve().then((function(){return _e})),"Utilizator.ts":()=>Promise.resolve().then((function(){return qe}))};function U(e){return v(this,void 0,void 0,(function(){var t=this;return y(this,(function(r){switch(r.label){case 0:return[4,Promise.all(e.map((function(e){return v(t,void 0,void 0,(function(){var t,r,i;return y(this,(function(n){switch(n.label){case 0:return t=("string"!=typeof(a=e)?"":a.charAt(0).toUpperCase()+a.slice(1))+".ts",i=[{}],[4,B[t]()];case 1:return r=b.apply(void 0,i.concat([n.sent()])),Object.defineProperty(r,"name",{writable:!1,value:String(t.split(".")[0]).toLowerCase()}),[2,r]}var a}))}))})))];case 1:return[2,r.sent()]}}))}))}var L={};function M(e){return v(this,void 0,void 0,(function(){var t,r=this;return y(this,(function(i){switch(i.label){case 0:return t={},[4,Promise.all(e.map((function(e){return v(r,void 0,void 0,(function(){var r;return y(this,(function(i){switch(i.label){case 0:return[4,L[e]()];case 1:return r=i.sent(),t[e]=r.default,[2]}}))}))})))];case 1:return i.sent(),[2,t]}}))}))}var Z,V={data:{1:16718.889847937582,2:73.39673015118248,52:.29726474721611,109:.01928139728606,131:82.93487490865303,328:120.35213797973842,512:.08430968253418,873:.13387198456458,1027:463.5173611366236,1274:4.87989584424322,1437:65.2321398955939,1567:.75488506864562,1759:.02564181291185,2781:1,2782:.73358960063382,2783:.18461084034855,2784:.76513904106654,2785:1.09837605100858,2786:.00130463047995,2787:.15264845061823,2788:.04489223954589,2789:.15940291493734,2790:1.18712961555995,2791:1.32298582023798,2792:.1289831612483,2793:.00328984047978,2794:7103609699e-14,2795:.29687244875239,2796:.01343354489152,2797:.00958847082238,2798:.00090472356172,2799:.0493242114452,2800:.24366471734893,2801:.11072439999278,2802:.69058293486698,2803:.02073102486185,2804:.00634559085313,2805:.26438729566167,2806:.01308246965158,2807:.11640190084304,2808:.7444453212356,2809:.03314386092836,2810:.12923402990475,2811:.03507664369415,2812:.06512299552234,2813:.27225701061802,2814:.60622594040799,2815:.15685536366916,2816:.02505637559226,2817:.24355196181105,2818:.00735835172921,2819:.00262295081967,2820:.00027522303093,2821:.01250478307953,2822:.27517167272732,2823:4330083583e-14,2824:.03567271426192,2832:.14540962181284,3526:.00958616074348,3527:.00207634199569,3528:.58737151248164,3529:.60638695249322,3530:.01182375552579,3531:2.65190791514955,3532:1,3533:.39204954879017,3534:.00163565018389,3535:.03883495145631,3536:.01716790099011,3537:.00778122494689,3538:.06384636011901,3539:.30211480362538,3540:.17226706908254,3541:.12882653455591,3542:.04083668820339,3543:.0008398299908,3544:2375014844e-14,3545:.00684381723323,3546:1.41043723554302,3547:.00914913083257,3548:.01179268479007,3549:.00024650687215,3550:3.26896736589879,3551:.0023335715661,3552:.00065832784727,3553:.00541632448134,3554:.10958153551127,3555:.05846468691985,3556:.01924839780186,3557:.00077361478531,3558:.0003517757028,3559:.06485084306096,3560:.02877089140738,3561:.00841834408697,3562:2.5974633173243,3563:1,3564:.27464982147762,3565:.01009591115598,3566:.26661874639065,3567:.00767695378474,3568:.36330608537693,3569:.14746350241449,3570:.00027133696246,3571:.02326686733874,3572:9676566611e-14,3573:154914468e-14},timestamp:"2020-11-17T09:24:42.559Z"},H=[1,2,52,109,131,328,512,873,1027,1274,1437,1567,1759,2781,2782,2783,2784,2785,2786,2787,2788,2789,2790,2791,2792,2793,2794,2795,2796,2797,2798,2799,2800,2801,2802,2803,2804,2805,2806,2807,2808,2809,2810,2811,2812,2813,2814,2815,2816,2817,2818,2819,2820,2821,2822,2823,2824,2832,3526,3527,3528,3529,3530,3531,3532,3533,3534,3535,3536,3537,3538,3539,3540,3541,3542,3543,3544,3545,3546,3547,3548,3549,3550,3551,3552,3553,3554,3555,3556,3557,3558,3559,3560,3561,3562,3563,3564,3565,3566,3567,3568,3569,3570,3571,3572,3573],W=[{code:"en",name:"English",nativeName:"English",supported:!0},{code:"fr",name:"French",nativeName:"français, langue française",supported:!0},{code:"ro",name:"Romanian, Moldavian, Moldovan",nativeName:"română",supported:!0},{code:"es",name:"Spanish; Castilian",nativeName:"español, castellano",supported:!0}],G=process.env.NODE_ENV,J=process.browser;(Z=exports.Taxonomii||(exports.Taxonomii={}))[Z.Apartament=0]="Apartament",Z[Z.Asociatie=1]="Asociatie",Z[Z.Bloc=2]="Bloc",Z[Z.Cheltuiala=3]="Cheltuiala",Z[Z.Contor=4]="Contor",Z[Z.Factura=5]="Factura",Z[Z.Furnizor=6]="Furnizor",Z[Z.Incasare=7]="Incasare",Z[Z.Serviciu=8]="Serviciu",Z[Z.Utilizator=9]="Utilizator";var K,Q=Object.keys(exports.Taxonomii).filter((function(e){return"number"==typeof exports.Taxonomii[e]}));!function(e){e[e.Feedback=0]="Feedback",e[e.Financiar=1]="Financiar",e[e.Preferinte=2]="Preferinte"}(K||(K={})),function(e){e[e.missingDB=0]="missingDB",e[e.invalidPluginDefinition=1]="invalidPluginDefinition",e[e.couldNotWriteFile=2]="couldNotWriteFile"}(exports.Errors||(exports.Errors={}));var X,Y,ee=[],te=r.observable.box("ro"),re=Object.keys(V.data),ie=r.observable.box(re[0]),ne=r.observable.box({rates:void 0,timestamp:0},{deep:!1}),ae=function(){function t(e,r){var i=this;void 0===e&&(e=e),void 0===r&&(r=[]),this.plugins=r,this.taxonomies=e.map((function(r){Object.defineProperty(t.prototype,r.form.plural,{value:r,writable:!1});var i=[],n=[],a=r.form.schema.required;return e.forEach((function(e){var t=e.form,o=[t.name+"Id",t.plural].filter((function(e){return r.form.fieldsIds.indexOf(e)>-1&&a.indexOf(e)>-1}))[0],s=e.form.fieldsIds.filter((function(e){return[r.form.name+"Id",r.form.plural].indexOf(e)>-1}));o&&i.push(o.replace("Id","")),s.length&&n.push(e.form.plural)})),i&&i.length>0&&(r.parents=i),n&&n.length>0&&(r.children=n),r.form.plural})),this.taxonomies.map((function(e){i[e]&&Object.defineProperty(i[e],"$lodger",{value:i,writable:!1})})),t.rates=V,this.supportedLangs=W}return Object.defineProperty(t.prototype,"i18n",{get:function(){return X?X[te.get()]:{}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"locale",{get:function(){return te.get()},set:function(e){var t=e.indexOf("-")>-1?e.split("-")[0]:e;if(W.map((function(e){return e.code})).indexOf(t)<0)throw new k("Language not supported");te.set(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t,"currencies",{get:function(){return Object.keys(V.data).map((function(e){return Number(e)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t,"currencyList",{get:function(){return H},enumerable:!1,configurable:!0}),Object.defineProperty(t,"displayCurrency",{get:function(){return ie.get()},set:function(e){ie.set(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t,"rates",{get:function(){return ne.get()},set:function(e){ne.set({rates:e.data,timestamp:e.timestamp||parseInt(Date.now()/1e3)})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rates",{get:function(){return t.rates.rates},enumerable:!1,configurable:!0}),t.prototype.updateRates=function(){var e=t.rates.timestamp;console.log(e,Date.now(),Date.now()-e),u.default.get("https://doriandrn.github.io/currencies-rates/rates.json").then((function(e){ne.set({rates:e.data,timestamp:e.timestamp})})).catch((function(e){console.error("could not fetch rates")}))},Object.defineProperty(t.prototype,"translate",{get:function(){var e=this.i18n;return function(t){return t.split(".").reduce((function(e,t){return e[t]}),e)}},enumerable:!1,configurable:!0}),t.prototype.put=function(e,t){var r;this[e].put(t);try{r=this.utilizatori.subscribers.main.activeId,console.log("iu",r)}catch(e){console.warn("no user selected")}},t.prototype.subscribe=function(e,t,r){var i=this;void 0===r&&(r="main"),Object.keys(e).forEach((function(e){i.taxonomies[e].subscribe(r,b({},t))}))},t.build=function(r){return v(this,void 0,void 0,(function(){var i,n,a,o,s=this;return y(this,(function(u){switch(u.label){case 0:return i=Object.assign({},b({},P.build),b({},r)),e.addRxPlugin(require("rxdb-search")),"development"===G?e.addRxPlugin(require("pouchdb-adapter-memory")):J?e.addRxPlugin(require("pouchdb-adapter-idb")):e.addRxPlugin(require("pouchdb-adapter-leveldb")),n=R,[4,e.createRxDatabase(i.db)];case 1:return n.db=u.sent(),[4,M(W.map((function(e){return e.code})))];case 2:return X=u.sent(),a={timestamps:!0},[4,U(Q)];case 3:return o=u.sent(),[4,Promise.all(o.map((function(e){return v(s,void 0,void 0,(function(){return y(this,(function(t){switch(t.label){case 0:return[4,R.init(e,a)];case 1:return[2,t.sent()]}}))}))})))];case 4:return[2,new t(u.sent(),ee)]}}))}))},t.use=function(e){if(!e||"object"!=typeof e)throw new k(exports.Errors.invalidPluginDefinition);e.name;ee.push(e)},t.prototype.search=function(e,t){return v(this,void 0,void 0,(function(){return y(this,(function(e){return[2,results]}))}))},t.prototype.destroy=function(){return v(this,void 0,void 0,(function(){var e;return y(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,R.destroy()];case 1:return t.sent(),[3,3];case 2:return e=t.sent(),console.error("Lodger could not be destroyed. Reason: ",e),[3,3];case 3:return[2]}}))}))},t.prototype.export=function(e,t,r){return v(this,void 0,void 0,(function(){return y(this,(function(t){switch(t.label){case 0:return[4,this.db.dump()];case 1:return t.sent(),e||(e=require("os").homeDir+"/downloads/"),[2]}}))}))},t.prototype.import=function(){return v(this,void 0,void 0,(function(){return y(this,(function(e){return[2]}))}))},m([r.computed],t.prototype,"i18n",null),m([r.computed],t.prototype,"rates",null),m([r.computed],t.prototype,"translate",null),t}(),oe="apartament/activeDoc",se={nr:{type:"number",search:!0,default:function(e){},value:function(e){return e[oe].nr},required:!0,index:!0,preview:0},proprietar:{type:"fullName",search:!0,placeholder:"Ion Barbu",oninput:{transform:"capitalize"},preview:1,v:"alpha_spaces|max:32",value:function(e){return e[oe].proprietar}},suprafata:{fieldset:0,type:"number",default:null,step:.01,value:function(e){return e[oe].suprafata}},locatari:{fieldset:0,index:!0,type:"number",default:2,min:0,max:10,value:function(e){return e[oe].locatari}},camere:{fieldset:0,type:"number",index:!0,default:2,max:12,min:1,value:function(e){return e[oe].camere}},etaj:{fieldset:1,type:"number",required:!0,value:function(e){return e[oe].etaj}},blocId:{required:!0,fieldset:1,value:function(e){return e[oe].bloc}},asociatieId:{required:!0,fieldset:1,value:function(e){return e["asociatie/activeDoc"]._id}},scara:{fieldset:1,type:"number",required:!0,value:function(e){return e[oe].scara}},balanta:{type:"$",default:null,required:!0,preview:2,index:!0,value:function(e){return e[oe].balanta}},contoare:{type:"contoare",value:function(e){return e[oe].contoare}},incasari:{type:"array",ref:"incasari",fieldset:2},cheltuieli:{type:"array",ref:"cheltuieli",fieldset:2}},ue={incaseaza:function(e){return v(this,void 0,void 0,(function(){var t;return y(this,(function(r){switch(r.label){case 0:return this.balanta||(this.balanta=0),t=this.incasari||[],this.balanta+=e.suma,t.push(e._id),this.incasari=t,[4,this.save()];case 1:return r.sent(),[2]}}))}))}},ce=Object.freeze({__proto__:null,methods:ue,fields:se,fieldsets:["descriere","localizare","registru"]}),le={initBalanta:function(e){return v(this,void 0,void 0,(function(){return y(this,(function(t){switch(t.label){case 0:return void 0!==this.balanta?[2]:(this.balanta=e.balanta,[4,this.save()]);case 1:return t.sent(),[2]}}))}))},incaseaza:function(e){return v(this,void 0,void 0,(function(){var t;return y(this,(function(r){switch(r.label){case 0:return this.balanta||(this.balanta=0),t=this.incasari||[],this.balanta+=e.suma,t.push(e._id),this.incasari=t,[4,this.save()];case 1:return r.sent(),[2]}}))}))},toggle_serviciu:function(e){return v(this,void 0,void 0,(function(){var t,r;return y(this,(function(i){return e?((t=this.servicii)||(t=[]),(r=t.indexOf(e))>-1?t.splice(r,1):t.push(e),this.update({$set:{servicii:t}}),[2]):[2]}))}))},UPDATEAZA:function(e){return v(this,void 0,void 0,(function(){var t=this;return y(this,(function(r){switch(r.label){case 0:return Object.keys(e).forEach((function(r){t[r]=e[r]})),[4,this.save()];case 1:return r.sent(),[2]}}))}))}},fe={selected:function(e){return v(this,void 0,void 0,(function(){return y(this,(function(t){switch(t.label){case 0:return[4,this.findOne(e).exec()];case 1:return[2,t.sent()]}}))}))}},de=Object.freeze({__proto__:null,fields:{name:{required:!0,focus:!0,index:!0,search:!0,preview:0,value:function(e){return e.activeDoc.name},v:"max:32|min:3",oninput:{transform:"capitalize"}},balanta:{type:"$",required:!0,index:!0,preview:1,value:function(e){return e.activeDoc.balanta}},utilizatori:{type:"array",ref:"utilizator",required:!0,value:function(e){return e.activeDoc.utilizatori}},servicii:{type:"array",ref:"serviciu",value:function(e){return e.activeDoc.servicii}}},methods:le,statics:fe,setari:{date:{fields:[{type:"button",click:"exportDb"},{type:"button",click:"importDb"}]},periculoase:{order:-1,avansat:!0,fields:[{type:"button",click:"sterge"}]}}}),pe=Object.freeze({__proto__:null,fields:{name:{placeholder:"ex. M11, COCOR-2, A3...",oninput:{transform:"uppercase:all"},type:"buildingName",required:!0,preview:0,index:!0,search:!0,v:"min:1|max:20",focus:!0,value:function(e){return e.activeDoc.name}},scari:{type:"scari",preview:1,default:[{id:1,etaje:4,lift:!1,mansarda:!1}],value:function(e){return e.activeDoc.scari}},adresa:{type:"textarea",search:!0,value:function(e){return e.activeDoc.adresa}},asociatieId:{required:!0,ref:"asociatie",value:function(e){return e.g.asociatieId}}}}),he=Object.freeze({__proto__:null,fields:{asociatieId:{ref:"asociatii",required:!0,index:!0},denumire:{preview:0,search:!0},proiect:{preview:3,index:!0},dataScadenta:{type:"dateTime",preview:0},catre:{type:"string",ref:"furnizori"},facturi:{type:"search",ref:"facturi"},suma:{type:"$",required:!0,index:!0,preview:1},distribuire:{type:"distribuire"},apartamenteEligibile:{type:"selApartamente",options:function(e){return e.getters["asociatie/apartamente"]}}}}),be=Object.freeze({__proto__:null,fields:{tip:{preview:0,search:!0}}}),me={suma:{type:"$",preview:0,index:!0,required:!0},nrFactura:{type:"number",search:!0,default:1,index:!0,value:function(e){return Number(e.nrUltimaChitanta||0)+1}},dataScadenta:{type:"date",preview:1},furnizorId:{required:!0,type:"search",ref:"furnizori"},asociatieId:{required:!0,index:!0,value:function(e){return e["asociatie/active"]||e["asociatie/selected"]}}},ve=Object.freeze({__proto__:null,fields:me}),ye=Object.freeze({__proto__:null,fields:{subiect:{required:!0},tip:{type:"select",options:["bug","enhacement","feature","other"],default:"bug",required:!0},mesaj:{required:!0,type:"textarea",placeholder:"Părerea / Sugestia / Critica ta"}}}),ge=Object.freeze({__proto__:null,fields:{name:{required:!0,preview:0,index:!0,search:!0},servicii:{type:"servicii",required:!0,value:function(e){return e.activeDoc.servicii},ref:"serviciu"},organizatie:{type:"organizatie"}}}),xe=Object.freeze({__proto__:null,fields:{suma:{type:"$",preview:1,index:!0,required:!0},nrChitanta:{type:"number",default:1,search:!0,preview:0,index:!0,value:function(e){return(e.activeDoc.nrUltimaChitanta||0)+1}},apartamentId:{required:!0,type:"search",ref:"apartamente",preview:2},blocId:{required:!0,index:!0,value:function(e){return e["bloc/selected"].id}},asociatieId:{required:!0,index:!0,value:function(e){return e["asociatie/selected"].id}},plata:{type:"object",default:function(){return{metoda:"fiat:banca",valoare:{suma:101.23,moneda:"RON"},achitata:{status:!1,la:0}}}}}}),Oe=["apa","electricitate","gaze","termoficare","internet","evacuare-gunoi-menajer"],we={empty:function(){var e=this;Oe.map((function(t){return v(e,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return[4,this.put({denumire:t})];case 1:return e.sent(),[2]}}))}))}))}},je=Object.freeze({__proto__:null,fields:{denumire:{required:!0,preview:0,primary:!0,index:!0,search:!0}},predefinite:Oe,hooks:we}),_e=Object.freeze({__proto__:null});!function(e){e[e.admin=0]="admin",e[e.moderator=1]="moderator",e[e.vizitator=2]="vizitator",e[e.locatar=3]="locatar",e[e.proprietar=4]="proprietar"}(Y||(Y={}));var Pe={UPDATEAZA:function(e){return v(this,void 0,void 0,(function(){var t=this;return y(this,(function(r){switch(r.label){case 0:return Object.keys(e).forEach((function(r){t[r]=e[r]})),[4,this.save()];case 1:return r.sent(),[2]}}))}))}},ke={onFirstTimeSubscribe:function(e){var t=e.put;e.dispatch;return v(void 0,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return[4,t({name:"Administrator",rol:"admin"})];case 1:return e.sent(),[2]}}))}))}},qe=Object.freeze({__proto__:null,fields:{avatar:{type:"userAvatar",preview:0},name:{type:"fullName",required:!0,primary:!0,preview:1,focus:!0,search:!0,oninput:{transform:"capitalize:all"},value:function(e){return e.activeDoc.name}},contact:{type:"contactFields",value:function(e){return e.activeDoc.contact}},rol:{type:"number",min:0,max:6,default:1}},hooks:ke,methods:Pe,settings:{locale:{type:"langSelect"},online:{campuri:[{id:"parola",required:!1,encrypted:!0},{id:"social",required:!1,encrypted:!0}]}}});exports.Lodger=ae,exports.notify=C,exports.taxonomies=Q;
